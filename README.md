# 恋のオラクル AI恋星譚 (Love Oracle: AI Romance Tale)

## 概要
LINEのトーク履歴をAIが心理学的に分析し、二人の「脈あり度」や「深層心理」を鑑定する、エンターテインメント型AI診断アプリケーションです。
Google Apps Script (GAS) と Gemini API を統合し、プライバシーに配慮した設計となっています。

## 主な機能
- **LINEトーク履歴解析**: アップロードされたテキストデータから発言頻度、時間帯、感情の変化を抽出。
- **マルチキャラクター鑑定**: 性格の異なる3種類のAI鑑定師を選択可能。性格に合わせたトーンで診断結果を生成。
- **感情温度グラフ**: 会話の盛り上がりを可視化。
- **アトミックな履歴管理**: ユーザーの過去の診断スコアを `UserProperties` に暗号化して保存し、前回との比較分析を実施。
- **PDF鑑定書の自動生成**: 診断結果をデザインされたPDF形式で出力。

## 技術的特長
- **プライバシーファースト設計**: 
  - ユーザーデータは管理者のスプレッドシートではなく、ユーザー自身の保存領域（UserProperties）にのみ保存。
  - 暗号化（PBKDF2 + HMAC）を用いたセキュアな鍵管理。
- **高度なAI制御 (TRC Foundation Core v25.8)**:
  - Gemini APIのレート制限を回避するサーキットブレーカーおよびフォールバックロジック。
  - 100KBのデータ制限を突破するチャンク分割保存。
- **ドキュメント自動生成**: `DocumentApp` を活用した動的な鑑定書のレイアウト・PDF変換。

## 構成
- `Code.gs`: バックエンド（解析、AI制御、PDF生成、暗号化）
- `Index.html`: フロントエンド（ReactベースのUI、グラフ表示）

## 技術的なこだわり
- **プロンプトエンジニアリング**: キャラクターの口調を一定に保つための厳格なシステムインストラクションを設計。
- **データ分析**: 単なる要約ではなく、トーク履歴の「初期・中期・後期」を抽出して長期的な関係性の変化を捉えるアルゴリズムを実装。

---
Developed by ちゃろ
